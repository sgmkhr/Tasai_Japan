<p class='guide-links'>
  <%= link_to I18n.t('top_page'),    root_path, data: { turbolinks: false } %>>
  <%= link_to I18n.t('menu'),        menu_path %>>
  <%= link_to I18n.t('menus.users'), users_path %>>
  @<%= @user.canonical_name %>
</p>

<div class='section-title'>
  <h2>
    <% if @user == current_user %>
      <%= I18n.t('mypage') %>
    <% else %>
      @<%= @user.canonical_name %>
    <% end %>
  </h2>
</div>

<section>

  <div class='row justify-content-center'>

    <div class='col-md-4'><!--ユーザーの情報-->
      <%= render 'public/users/profile_info', user: @user %>
    </div>

    <div class='col-md-8'>

      <!--以下、マイページの場合に表示される内容-->
      <% if @user == current_user %>
        <%= link_to new_post_path do %>
          <%= I18n.t('posts.new.title') %>
          <i class="fa-solid fa-plus"></i>
        <% end %>

        <ul id="tab-menu" class='d-flex justify-content-center mt-3'>
          <li><a href="#user_posts_tab" class="active"><i class="fa-solid fa-user"></i></a></li>
          <li><a href="#bookmarked_posts_tab" class=""><i class="fa-solid fa-bookmark"></i></a></li>
          <li><a href="#followusers_posts_tab" class=""><i class="fa-solid fa-users"></i></a></li>
        </ul>

        <div id='tab-contents'>

          <!--以下、「ユーザー投稿一覧」タブ選択時の表示-->
          <div id='user_posts_tab' class='tab'>
            <p class='text-center tab-title'><%= I18n.t('users.show.user_posts_tab') %></p>
            <!--検索バー-->
            <%= form_with url: user_path(@user.canonical_name), method: :get, local: true do |f| %>
              <div class='row justify-content-md-end justify-content-center'>
                <div class='form-group col-md-5 col-10 mb-1'>
                  <%= f.select :prefecture, Post.prefectures.keys.map {|k| [I18n.t("enums.post.prefecture.#{k}"), k]}, class: 'form-control' %>
                  <%= f.select :sort, [[I18n.t('sort.latest'), 'latest'],[I18n.t('sort.old'), 'old'],[I18n.t('sort.favorites_count'), 'favorites_count']], class: 'form-control ml-1' %>
                </div>
              </div>
              <div class='row justify-content-md-end justify-content-center'>
                <div class='form-group col-md-5 col-9'>
                  <%= f.text_field :keyword, class: 'form-control', placeholder: I18n.t('search_blank') %>
                </div>
                <div class='form-group mt-1'>
                  <%= f.submit I18n.t('search'), class: 'btn btn-sm success-btn' %>
                </div>
              </div>
            <% end %>
            <!--ソート切り替えリンク-->
            <p class='md-font text-center mb-0'><%= I18n.t('sort.with_display_all') %></p>
            <div class='text-center pb-2'>
            <%= link_to I18n.t('sort.latest'), user_path(@user.canonical_name, sort: 'latest') %>
            |<%= link_to I18n.t('sort.old'), user_path(@user.canonical_name, sort: 'old') %>
            |<%= link_to I18n.t('sort.favorites_count'), user_path(@user.canonical_name, sort: 'favorites_count') %>
            </div>
            <!--ユーザーの投稿一覧表示-->
            <%= render 'public/posts/index', posts: @posts %>
          </div>

          <!--以下、「ブックマーク一覧」タブ選択時の表示-->
          <div id='bookmarked_posts_tab' class='tab'>
            <p class='text-center tab-title'><%= I18n.t('users.show.bookmarked_posts_tab') %></p>
            <!--ブックマーク検索バー-->
            <%= form_with url: user_path(@user.canonical_name), method: :get, local: true do |f| %>
              <div class='row justify-content-md-end justify-content-center'>
                <div class='form-group col-md-5 col-9'>
                  <%= f.text_field :keyword_in_bookmarks, class: 'form-control', placeholder: I18n.t('search_blank') %>
                </div>
                <div class='form-group mt-1'>
                  <%= f.submit I18n.t('search'), class: 'btn btn-sm success-btn' %>
                </div>
              </div>
            <% end %>
            <!--ユーザーのブックマーク一覧表示-->
            <%= render 'public/posts/index', posts: @bookmarked_posts %>
          </div>

          <!--以下、「フォローユーザー投稿一覧」タブ選択時の表示-->
          <div id='followusers_posts_tab' class='tab'>
            <p class='text-center tab-title'><%= I18n.t('users.show.followusers_posts_tab') %></p>
            <!--フォローユーザー投稿一覧表示-->
            <%= render 'public/posts/index', posts: @friends_posts %>
          </div>
        </div>
        <%= javascript_pack_tag 'mypage_tab' %>

      <!--以下、マイページではない場合に表示される内容-->
      <% else %>
        <!--検索バー-->
        <%= form_with url: user_path(@user.canonical_name), method: :get, local: true do |f| %>
          <div class='row justify-content-md-end justify-content-center'>
            <div class='form-group col-md-5 col-10 mb-1'>
              <%= f.select :prefecture, Post.prefectures.keys.map {|k| [I18n.t("enums.post.prefecture.#{k}"), k]}, class: 'form-control' %>
              <%= f.select :sort, [[I18n.t('sort.latest'), 'latest'],[I18n.t('sort.old'), 'old'],[I18n.t('sort.favorites_count'), 'favorites_count']], class: 'form-control ml-1' %>
            </div>
          </div>
          <div class='row justify-content-md-end justify-content-center'>
            <div class='form-group col-md-5 col-9'>
              <%= f.text_field :keyword, class: 'form-control', placeholder: I18n.t('search_blank') %>
            </div>
            <div class='form-group mt-1'>
              <%= f.submit I18n.t('search'), class: 'btn btn-sm success-btn' %>
            </div>
          </div>
        <% end %>

        <!--ソート切り替えリンク-->
        <p class='md-font text-center mb-0'><%= I18n.t('sort.with_display_all') %></p>
        <div class='text-center pb-2'>
        <%= link_to I18n.t('sort.latest'), user_path(@user.canonical_name, sort: 'latest') %>
        |<%= link_to I18n.t('sort.old'), user_path(@user.canonical_name, sort: 'old') %>
        |<%= link_to I18n.t('sort.favorites_count'), user_path(@user.canonical_name, sort: 'favorites_count') %>
        </div>

        <!--ユーザーの投稿一覧表示-->
        <%= render 'public/posts/index', posts: @posts %>

      <% end %>

    </div>
  </div>

</section>
